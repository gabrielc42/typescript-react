var ae=Object.assign;function ve(e){let t=o=>{if(o===null)r.write8(0);else if(typeof o=="boolean")r.write8(1),r.write8(+o);else if(typeof o=="number")r.write8(2),r.write32(o|0);else if(typeof o=="string")r.write8(3),r.write(Z(o));else if(o instanceof Uint8Array)r.write8(4),r.write(o);else if(o instanceof Array){r.write8(5),r.write32(o.length);for(let a of o)t(a)}else{let a=Object.keys(o);r.write8(6),r.write32(a.length);for(let l of a)r.write(Z(l)),t(o[l])}},r=new be;return r.write32(0),r.write32(e.id<<1|+!e.isRequest),t(e.value),we(r.buf,r.len-4,0),r.buf.subarray(0,r.len)}function De(e){let t=()=>{switch(r.read8()){case 0:return null;case 1:return!!r.read8();case 2:return r.read32();case 3:return ne(r.read());case 4:return r.read();case 5:{let i=r.read32(),m=[];for(let v=0;v<i;v++)m.push(t());return m}case 6:{let i=r.read32(),m={};for(let v=0;v<i;v++)m[ne(r.read())]=t();return m}default:throw new Error("Invalid packet")}},r=new be(e),o=r.read32(),a=(o&1)==0;o>>>=1;let l=t();if(r.ptr!==e.length)throw new Error("Invalid packet");return{id:o,isRequest:a,value:l}}var be=class{constructor(t=new Uint8Array(1024)){this.buf=t;this.len=0;this.ptr=0}_write(t){if(this.len+t>this.buf.length){let r=new Uint8Array((this.len+t)*2);r.set(this.buf),this.buf=r}return this.len+=t,this.len-t}write8(t){let r=this._write(1);this.buf[r]=t}write32(t){let r=this._write(4);we(this.buf,t,r)}write(t){let r=this._write(4+t.length);we(this.buf,t.length,r),this.buf.set(t,r+4)}_read(t){if(this.ptr+t>this.buf.length)throw new Error("Invalid packet");return this.ptr+=t,this.ptr-t}read8(){return this.buf[this._read(1)]}read32(){return Re(this.buf,this._read(4))}read(){let t=this.read32(),r=new Uint8Array(t),o=this._read(r.length);return r.set(this.buf.subarray(o,o+t)),r}},Z,ne;if(typeof TextEncoder!="undefined"&&typeof TextDecoder!="undefined"){let e=new TextEncoder,t=new TextDecoder;Z=r=>e.encode(r),ne=r=>t.decode(r)}else if(typeof Buffer!="undefined")Z=e=>{let t=Buffer.from(e);return t instanceof Uint8Array||(t=new Uint8Array(t)),t},ne=e=>Buffer.from(e).toString();else throw new Error("No UTF-8 codec found");function Re(e,t){return e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24}function we(e,t,r){e[r++]=t,e[r++]=t>>8,e[r++]=t>>16,e[r++]=t>>24}function Ee(e){if(e+="",e.indexOf(",")>=0)throw new Error(`Invalid target: ${e}`);return e}var Oe=()=>null,M=e=>typeof e=="boolean"?null:"a boolean",We=e=>typeof e=="boolean"||typeof e=="object"&&!Array.isArray(e)?null:"a boolean or an object",p=e=>typeof e=="string"?null:"a string",$e=e=>e instanceof RegExp?null:"a RegExp object",ue=e=>typeof e=="number"&&e===(e|0)?null:"an integer",Se=e=>typeof e=="function"?null:"a function",V=e=>Array.isArray(e)?null:"an array",me=e=>typeof e=="object"&&e!==null&&!Array.isArray(e)?null:"an object",Be=e=>typeof e=="object"&&!Array.isArray(e)?null:"an object or null",xe=e=>typeof e=="string"||typeof e=="boolean"?null:"a string or a boolean",Me=e=>typeof e=="string"||typeof e=="object"&&e!==null&&!Array.isArray(e)?null:"a string or an object",qe=e=>typeof e=="string"||Array.isArray(e)?null:"a string or an array",Ke=e=>typeof e=="string"||e instanceof Uint8Array?null:"a string or a Uint8Array";function n(e,t,r,o){let a=e[r];if(t[r+""]=!0,a===void 0)return;let l=o(a);if(l!==null)throw new Error(`"${r}" must be ${l}`);return a}function K(e,t,r){for(let o in e)if(!(o in t))throw new Error(`Invalid option ${r}: "${o}"`)}function Ie(e){let t=Object.create(null),r=n(e,t,"wasmURL",p),o=n(e,t,"worker",M);return K(e,t,"in startService() call"),{wasmURL:r,worker:o}}function ye(e,t,r,o,a){let l=n(t,r,"color",M),i=n(t,r,"logLevel",p),m=n(t,r,"errorLimit",ue);l?e.push(`--color=${l}`):o&&e.push("--color=true"),e.push(`--log-level=${i||a}`),e.push(`--error-limit=${m||0}`)}function Ae(e,t,r){let o=n(t,r,"sourcesContent",M),a=n(t,r,"target",qe),l=n(t,r,"format",p),i=n(t,r,"globalName",p),m=n(t,r,"minify",M),v=n(t,r,"minifySyntax",M),h=n(t,r,"minifyWhitespace",M),b=n(t,r,"minifyIdentifiers",M),F=n(t,r,"charset",p),B=n(t,r,"treeShaking",xe),$=n(t,r,"jsxFactory",p),D=n(t,r,"jsxFragment",p),C=n(t,r,"define",me),z=n(t,r,"pure",V),X=n(t,r,"avoidTDZ",M),Y=n(t,r,"keepNames",M),H=n(t,r,"banner",p),d=n(t,r,"footer",p);if(o!==void 0&&e.push(`--sources-content=${o}`),a&&(Array.isArray(a)?e.push(`--target=${Array.from(a).map(Ee).join(",")}`):e.push(`--target=${Ee(a)}`)),l&&e.push(`--format=${l}`),i&&e.push(`--global-name=${i}`),m&&e.push("--minify"),v&&e.push("--minify-syntax"),h&&e.push("--minify-whitespace"),b&&e.push("--minify-identifiers"),F&&e.push(`--charset=${F}`),B!==void 0&&B!==!0&&e.push(`--tree-shaking=${B}`),$&&e.push(`--jsx-factory=${$}`),D&&e.push(`--jsx-fragment=${D}`),C)for(let u in C){if(u.indexOf("=")>=0)throw new Error(`Invalid define: ${u}`);e.push(`--define:${u}=${C[u]}`)}if(z)for(let u of z)e.push(`--pure:${u}`);X&&e.push("--avoid-tdz"),Y&&e.push("--keep-names"),H&&e.push(`--banner=${H}`),d&&e.push(`--footer=${d}`)}function _e(e,t,r,o,a){var j;let l=[],i=Object.create(null),m=null,v=null,h=null;ye(l,t,i,r,o),Ae(l,t,i);let b=n(t,i,"sourcemap",xe),F=n(t,i,"bundle",M),B=n(t,i,"watch",We),$=n(t,i,"splitting",M),D=n(t,i,"preserveSymlinks",M),C=n(t,i,"metafile",p),z=n(t,i,"outfile",p),X=n(t,i,"outdir",p),Y=n(t,i,"outbase",p),H=n(t,i,"platform",p),d=n(t,i,"tsconfig",p),u=n(t,i,"resolveExtensions",V),c=n(t,i,"nodePaths",V),y=n(t,i,"mainFields",V),N=n(t,i,"external",V),U=n(t,i,"loader",me),I=n(t,i,"outExtension",me),P=n(t,i,"publicPath",p),A=n(t,i,"chunkNames",p),W=n(t,i,"assetNames",p),f=n(t,i,"inject",V),g=n(t,i,"entryPoints",V),S=n(t,i,"absWorkingDir",p),R=n(t,i,"stdin",me),k=(j=n(t,i,"write",M))!=null?j:a,E=n(t,i,"incremental",M)===!0,w=n(t,i,"plugins",V);if(K(t,i,`in ${e}() call`),b&&l.push(`--sourcemap${b===!0?"":`=${b}`}`),F&&l.push("--bundle"),B)if(l.push("--watch"),typeof B=="boolean")h={};else{let s=Object.create(null),O=n(B,s,"onRebuild",Se);K(B,s,`on "watch" in ${e}() call`),h={onRebuild:O}}if($&&l.push("--splitting"),D&&l.push("--preserve-symlinks"),C&&l.push(`--metafile=${C}`),z&&l.push(`--outfile=${z}`),X&&l.push(`--outdir=${X}`),Y&&l.push(`--outbase=${Y}`),H&&l.push(`--platform=${H}`),d&&l.push(`--tsconfig=${d}`),u){let s=[];for(let O of u){if(O+="",O.indexOf(",")>=0)throw new Error(`Invalid resolve extension: ${O}`);s.push(O)}l.push(`--resolve-extensions=${s.join(",")}`)}if(P&&l.push(`--public-path=${P}`),A&&l.push(`--chunk-names=${A}`),W&&l.push(`--asset-names=${W}`),y){let s=[];for(let O of y){if(O+="",O.indexOf(",")>=0)throw new Error(`Invalid main field: ${O}`);s.push(O)}l.push(`--main-fields=${s.join(",")}`)}if(N)for(let s of N)l.push(`--external:${s}`);if(f)for(let s of f)l.push(`--inject:${s}`);if(U)for(let s in U){if(s.indexOf("=")>=0)throw new Error(`Invalid loader extension: ${s}`);l.push(`--loader:${s}=${U[s]}`)}if(I)for(let s in I){if(s.indexOf("=")>=0)throw new Error(`Invalid out extension: ${s}`);l.push(`--out-extension:${s}=${I[s]}`)}if(g)for(let s of g){if(s+="",s.startsWith("-"))throw new Error(`Invalid entry point: ${s}`);l.push(s)}if(R){let s=Object.create(null),O=n(R,s,"contents",p),T=n(R,s,"resolveDir",p),L=n(R,s,"sourcefile",p),_=n(R,s,"loader",p);K(R,s,'in "stdin" object'),L&&l.push(`--sourcefile=${L}`),_&&l.push(`--loader=${_}`),T&&(v=T+""),m=O?O+"":""}let x=[];if(c)for(let s of c)s+="",x.push(s);return{flags:l,write:k,plugins:w,stdinContents:m,stdinResolveDir:v,absWorkingDir:S,incremental:E,nodePaths:x,watch:h}}function Ve(e,t,r,o){let a=[],l=Object.create(null);ye(a,t,l,r,o),Ae(a,t,l);let i=n(t,l,"sourcemap",xe),m=n(t,l,"tsconfigRaw",Me),v=n(t,l,"sourcefile",p),h=n(t,l,"loader",p);return K(t,l,`in ${e}() call`),i&&a.push(`--sourcemap=${i===!0?"external":i}`),m&&a.push(`--tsconfig-raw=${typeof m=="string"?m:JSON.stringify(m)}`),v&&a.push(`--sourcefile=${v}`),h&&a.push(`--loader=${h}`),a}function je(e){let t=new Map,r=new Map,o=new Map,a=new Map,l=0,i=!1,m=0,v=0,h=new Uint8Array(16*1024),b=0,F=d=>{let u=b+d.length;if(u>h.length){let y=new Uint8Array(u*2);y.set(h),h=y}h.set(d,b),b+=d.length;let c=0;for(;c+4<=b;){let y=Re(h,c);if(c+4+y>b)break;c+=4,X(h.slice(c,c+y)),c+=y}c>0&&(h.set(h.slice(c)),b-=c)},B=()=>{i=!0;for(let d of t.values())d("The service was stopped",null);t.clear();for(let d of a.values())d.onWait("The service was stopped");a.clear();for(let d of o.values())try{d(new Error("The service was stopped"),null)}catch(u){console.error(u)}o.clear()},$=(d,u,c)=>{if(i)return c("The service is no longer running",null);let y=m++;t.set(y,(N,U)=>{try{c(N,U)}finally{d&&d.unref()}}),d&&d.ref(),e.writeToStdin(ve({id:y,isRequest:!0,value:u}))},D=(d,u)=>{if(i)throw new Error("The service is no longer running");e.writeToStdin(ve({id:d,isRequest:!1,value:u}))},C=async(d,u)=>{try{switch(u.command){case"ping":{D(d,{});break}case"resolve":{let c=r.get(u.key);c?D(d,await c(u)):D(d,{});break}case"load":{let c=r.get(u.key);c?D(d,await c(u)):D(d,{});break}case"serve-request":{let c=a.get(u.serveID);c&&c.onRequest&&c.onRequest(u.args),D(d,{});break}case"serve-wait":{let c=a.get(u.serveID);c&&c.onWait(u.error),D(d,{});break}case"watch-rebuild":{let c=o.get(u.watchID);try{c&&c(null,u.args)}catch(y){console.error(y)}D(d,{});break}default:throw new Error("Invalid command: "+u.command)}}catch(c){D(d,{errors:[ce(c,e,null,void 0)]})}},z=!0,X=d=>{if(z){z=!1;let c=String.fromCharCode(...d);if(c!=="0.8.57")throw new Error(`Cannot start service: Host version "0.8.57" does not match binary version ${JSON.stringify(c)}`);return}let u=De(d);if(u.isRequest)C(u.id,u.value);else{let c=t.get(u.id);t.delete(u.id),u.value.error?c(u.value.error,{}):c(null,u.value)}},Y=(d,u,c,y)=>{if(e.isSync)throw new Error("Cannot use plugins in synchronous API calls");let N={},U={},I=0,P=0;u.plugins=[];for(let f of d){let g={};if(typeof f!="object")throw new Error(`Plugin at index ${P} must be an object`);let S=n(f,g,"name",p),R=n(f,g,"setup",Se);if(typeof S!="string"||S==="")throw new Error(`Plugin at index ${P} is missing a name`);if(typeof R!="function")throw new Error(`[${S}] Plugin is missing a setup function`);K(f,g,`on plugin ${JSON.stringify(S)}`);let k={name:S,onResolve:[],onLoad:[]};P++,R({onResolve(E,w){let x='This error came from the "onResolve" callback registered here',j=Pe(new Error(x),e,"onResolve"),s={},O=n(E,s,"filter",$e),T=n(E,s,"namespace",p);if(K(E,s,`in onResolve() call for plugin ${JSON.stringify(S)}`),O==null)throw new Error(`[${k.name}] onResolve() call is missing a filter`);let L=I++;N[L]={name:S,callback:w,note:j},k.onResolve.push({id:L,filter:O.source,namespace:T||""})},onLoad(E,w){let x='This error came from the "onLoad" callback registered here',j=Pe(new Error(x),e,"onLoad"),s={},O=n(E,s,"filter",$e),T=n(E,s,"namespace",p);if(K(E,s,`in onLoad() call for plugin ${JSON.stringify(S)}`),O==null)throw new Error(`[${k.name}] onLoad() call is missing a filter`);let L=I++;U[L]={name:S,callback:w,note:j},k.onLoad.push({id:L,filter:O.source,namespace:T||""})}}),u.plugins.push(k)}let A=async f=>{switch(f.command){case"resolve":{let g={},S,R,k;for(let E of f.ids)try{({name:S,callback:R,note:k}=N[E]);let w=await R({path:f.path,importer:f.importer,namespace:f.namespace,resolveDir:f.resolveDir,kind:f.kind,pluginData:y.load(f.pluginData)});if(w!=null){if(typeof w!="object")throw new Error(`Expected onResolve() callback in plugin ${JSON.stringify(S)} to return an object`);let x={},j=n(w,x,"pluginName",p),s=n(w,x,"path",p),O=n(w,x,"namespace",p),T=n(w,x,"external",M),L=n(w,x,"pluginData",Oe),_=n(w,x,"errors",V),J=n(w,x,"warnings",V);K(w,x,`from onResolve() callback in plugin ${JSON.stringify(S)}`),g.id=E,j!=null&&(g.pluginName=j),s!=null&&(g.path=s),O!=null&&(g.namespace=O),T!=null&&(g.external=T),L!=null&&(g.pluginData=y.store(L)),_!=null&&(g.errors=he(_,"errors",y)),J!=null&&(g.warnings=he(J,"warnings",y));break}}catch(w){return{id:E,errors:[ce(w,e,y,k)]}}return g}case"load":{let g={},S,R,k;for(let E of f.ids)try{({name:S,callback:R,note:k}=U[E]);let w=await R({path:f.path,namespace:f.namespace,pluginData:y.load(f.pluginData)});if(w!=null){if(typeof w!="object")throw new Error(`Expected onLoad() callback in plugin ${JSON.stringify(S)} to return an object`);let x={},j=n(w,x,"pluginName",p),s=n(w,x,"contents",Ke),O=n(w,x,"resolveDir",p),T=n(w,x,"pluginData",Oe),L=n(w,x,"loader",p),_=n(w,x,"errors",V),J=n(w,x,"warnings",V);K(w,x,`from onLoad() callback in plugin ${JSON.stringify(S)}`),g.id=E,j!=null&&(g.pluginName=j),s instanceof Uint8Array?g.contents=s:s!=null&&(g.contents=Z(s)),O!=null&&(g.resolveDir=O),T!=null&&(g.pluginData=y.store(T)),L!=null&&(g.loader=L),_!=null&&(g.errors=he(_,"errors",y)),J!=null&&(g.warnings=he(J,"warnings",y));break}}catch(w){return{id:E,errors:[ce(w,e,y,k)]}}return g}default:throw new Error("Invalid command: "+f.command)}},W=0;return{ref(){++W==1&&r.set(c,A)},unref(){--W==0&&r.delete(c)}}},H=(d,u,c)=>{let y={},N=n(u,y,"port",ue),U=n(u,y,"host",p),I=n(u,y,"servedir",p),P=n(u,y,"onRequest",Se),A=l++,W,f=new Promise((g,S)=>{W=R=>{a.delete(A),R!==null?S(new Error(R)):g()}});return c.serve={serveID:A},K(u,y,"in serve() call"),N!==void 0&&(c.serve.port=N),U!==void 0&&(c.serve.host=U),I!==void 0&&(c.serve.servedir=I),a.set(A,{onRequest:P,onWait:W}),{wait:f,stop(){$(d,{command:"serve-stop",serveID:A},()=>{})}}};return{readFromStdout:F,afterClose:B,service:{buildOrServe(d,u,c,y,N,U,I){let P,A=Te(),W="info",f={ref(){P&&P.ref(),u&&u.ref()},unref(){P&&P.unref(),u&&u.unref()}};try{let g=v++,S=!e.isBrowser,{flags:R,write:k,plugins:E,stdinContents:w,stdinResolveDir:x,absWorkingDir:j,incremental:s,nodePaths:O,watch:T}=_e(d,y,N,W,S),L={command:"build",key:g,flags:R,write:k,stdinContents:w,stdinResolveDir:x,absWorkingDir:j||U,incremental:s,nodePaths:O,hasOnRebuild:!!(T&&T.onRebuild)},_=c&&H(f,c,L);E&&E.length>0&&(P=Y(E,L,g,A));let J,de,ke=(q,ee)=>{let ie=le(q.errors,A),oe=le(q.warnings,A);if(ie.length>0)return ee(fe("Build failed",ie,oe),null);let te={warnings:oe};if(q.outputFiles&&(te.outputFiles=q.outputFiles.map(Fe)),q.rebuildID!==void 0){if(!J){let re=!1;J=()=>new Promise((pe,G)=>{if(re||i)throw new Error("Cannot rebuild");$(f,{command:"rebuild",rebuildID:q.rebuildID},(se,ge)=>{if(se)return ee(new Error(se),null);ke(ge,(Q,Ne)=>{Q?G(Q):pe(Ne)})})}),f.ref(),J.dispose=()=>{re||(re=!0,$(f,{command:"rebuild-dispose",rebuildID:q.rebuildID},()=>{}),f.unref())}}te.rebuild=J}if(q.watchID!==void 0){if(!de){let re=!1;f.ref(),de=()=>{re||(re=!0,o.delete(q.watchID),$(f,{command:"watch-stop",watchID:q.watchID},()=>{}),f.unref())},T&&T.onRebuild&&o.set(q.watchID,(pe,G)=>{if(pe)return T.onRebuild(pe,null);let se=le(G.errors,A),ge=le(G.warnings,A);if(se.length>0)return T.onRebuild(fe("Build failed",se,ge),null);let Q={warnings:ge};G.outputFiles&&(Q.outputFiles=G.outputFiles.map(Fe)),G.rebuildID!==void 0&&(Q.rebuild=J),Q.stop=de,T.onRebuild(null,Q)})}te.stop=de}return ee(null,te)};if(k&&e.isBrowser)throw new Error('Cannot enable "write" in the browser');if(s&&e.isSync)throw new Error('Cannot use "incremental" with a synchronous build');$(f,L,(q,ee)=>{if(q)return I(new Error(q),null);if(_){let ie=ee,oe=!1;f.ref();let te={port:ie.port,host:ie.host,wait:_.wait,stop(){oe||(oe=!0,_.stop(),f.unref())}};return f.ref(),_.wait.then(f.unref,f.unref),I(null,te)}return ke(ee,I)})}catch(g){let S=[];try{ye(S,y,{},N,W)}catch(k){}let R=ce(g,e,A,void 0);$(f,{command:"error",flags:S,error:R},()=>{R.detail=A.load(R.detail),I(fe("Build failed",[R],[]),null)})}},transform(d,u,c,y,N,U,I){let P=Te(),A="silent",W=f=>{try{let g=Ve(d,y,N,A);$(u,{command:"transform",flags:g,inputFS:f!==null,input:f!==null?f:c},(R,k)=>{if(R)return I(new Error(R),null);let E=le(k.errors,P),w=le(k.warnings,P),x=1,j=()=>--x==0&&I(null,{warnings:w,code:k.code,map:k.map});if(E.length>0)return I(fe("Transform failed",E,w),null);k.codeFS&&(x++,U.readFile(k.code,(s,O)=>{s!==null?I(s,null):(k.code=O,j())})),k.mapFS&&(x++,U.readFile(k.map,(s,O)=>{s!==null?I(s,null):(k.map=O,j())})),j()})}catch(g){let S=[];try{ye(S,y,{},N,A)}catch(k){}let R=ce(g,e,P,void 0);$(u,{command:"error",flags:S,error:R},()=>{R.detail=P.load(R.detail),I(fe("Transform failed",[R],[]),null)})}};if(c.length>1024*1024){let f=W;W=()=>U.writeFile(c,f)}W(null)}}}}function Te(){let e=new Map,t=0;return{load(r){return e.get(r)},store(r){if(r===void 0)return-1;let o=t++;return e.set(o,r),o}}}function Pe(e,t,r){try{let o=(e.stack+"").split(`
`,4);o.splice(1,1);let a=Le(t,o,r);if(a)return{text:e.message,location:a}}catch(o){}}function ce(e,t,r,o){let a="Internal error",l=null;try{a=(e&&e.message||e)+""}catch(i){}try{l=Le(t,(e.stack+"").split(`
`,3),"")}catch(i){}return{text:a,location:l,notes:o?[o]:[],detail:r?r.store(e):-1}}function Le(e,t,r){let o="    at ";if(e.readFileSync&&!t[0].startsWith(o)&&t[1].startsWith(o)){let a=t[1].slice(o.length);for(;;){let l=/^\S+ \((.*)\)$/.exec(a);if(l){a=l[1];continue}if(l=/^eval at \S+ \((.*)\)(?:, \S+:\d+:\d+)?$/.exec(a),l){a=l[1];continue}if(l=/^(\S+):(\d+):(\d+)$/.exec(a),l){let m=e.readFileSync(l[1],"utf8").split(/\r\n|\r|\n|\u2028|\u2029/)[+l[2]-1]||"",v=+l[3]-1,h=m.slice(v,v+r.length)===r?r.length:0;return{file:l[1],namespace:"file",line:+l[2],column:Z(m.slice(0,v)).length,length:Z(m.slice(v,v+h)).length,lineText:m+`
`+t.slice(1).join(`
`)}}break}}return null}function fe(e,t,r){let o=5,a=t.length<1?"":` with ${t.length} error${t.length<2?"":"s"}:`+t.slice(0,o+1).map((i,m)=>{if(m===o)return`
...`;if(!i.location)return`
error: ${i.text}`;let{file:v,line:h,column:b}=i.location;return`
${v}:${h}:${b}: error: ${i.text}`}).join(""),l=new Error(`${e}${a}`);return l.errors=t,l.warnings=r,l}function le(e,t){for(let r of e)r.detail=t.load(r.detail);return e}function Ue(e,t){if(e==null)return null;let r={},o=n(e,r,"file",p),a=n(e,r,"namespace",p),l=n(e,r,"line",ue),i=n(e,r,"column",ue),m=n(e,r,"length",ue),v=n(e,r,"lineText",p);return K(e,r,t),{file:o||"",namespace:a||"",line:l||0,column:i||0,length:m||0,lineText:v||""}}function he(e,t,r){let o=[],a=0;for(let l of e){let i={},m=n(l,i,"text",p),v=n(l,i,"location",Be),h=n(l,i,"notes",V),b=n(l,i,"detail",Oe),F=`in element ${a} of "${t}"`;K(l,i,F);let B=[];if(h)for(let $ of h){let D={},C=n($,D,"text",p),z=n($,D,"location",Be);K($,D,F),B.push({text:C||"",location:Ue(z,F)})}o.push({text:m||"",location:Ue(v,F),notes:B,detail:r.store(b)}),a++}return o}function Fe({path:e,contents:t}){let r=null;return{path:e,contents:t,get text(){return r===null&&(r=ne(t)),r}}}function Ce(e,t){let r=new Map;return async o=>{let a=e(),l=JSON.stringify(o||{}),i=l,m=r.get(i);m===void 0&&(m=t(JSON.parse(l)),r.set(i,m));try{let v=await m;return{build:(h={})=>(a&&(h.absWorkingDir||(h=ae(ae({},h),{absWorkingDir:a}))),v.build(h)),serve(h,b={}){return a&&(b.absWorkingDir||(b=ae(ae({},b),{absWorkingDir:a}))),v.serve(h,b)},transform(h,b){return v.transform(h,b)},stop(){}}}catch(v){throw r.delete(i),v}}}var Je="0.8.57",ze=()=>{throw new Error('The "build" API only works in node')},Ze=()=>{throw new Error('The "serve" API only works in node')},He=()=>{throw new Error('The "transform" API only works in node')},Ge=()=>{throw new Error('The "buildSync" API only works in node')},Qe=()=>{throw new Error('The "transformSync" API only works in node')},Xe=Ce(()=>"",async e=>{if(!e)throw new Error('Must provide an options object to "startService"');e=Ie(e);let t=e.wasmURL,r=e.worker!==!1;if(!t)throw new Error('Must provide the "wasmURL" option');t+="";let o=await fetch(t);if(!o.ok)throw new Error(`Failed to download ${JSON.stringify(t)}`);let a=await o.arrayBuffer(),l='{let global={};for(let o=self;o;o=Object.getPrototypeOf(o))for(let k of Object.getOwnPropertyNames(o))if(!(k in global))Object.defineProperty(global,k,{get:()=>self[k]});\n// Copyright 2018 The Go Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style\n// license that can be found in the LICENSE file.\n(()=>{if(typeof global=="undefined")if(typeof window!="undefined")window.global=window;else if(typeof self!="undefined")self.global=self;else throw new Error("cannot export Go (neither global, window nor self is defined)");if(!global.require&&typeof require!="undefined"&&(global.require=require),!global.fs&&global.require){const r=require("fs");typeof r=="object"&&r!==null&&Object.keys(r).length!==0&&(global.fs=Object.assign({},r,{write(n,s,i,l,f,h){if(i===0&&l===s.length&&f===null){if(n===process.stdout.fd){try{process.stdout.write(s,u=>u?h(u,0,null):h(null,l,s))}catch(u){h(u,0,null)}return}if(n===process.stderr.fd){try{process.stderr.write(s,u=>u?h(u,0,null):h(null,l,s))}catch(u){h(u,0,null)}return}}r.write(n,s,i,l,f,h)}}))}const a=()=>{const r=new Error("not implemented");return r.code="ENOSYS",r};if(!global.fs){let r="";global.fs={constants:{O_WRONLY:-1,O_RDWR:-1,O_CREAT:-1,O_TRUNC:-1,O_APPEND:-1,O_EXCL:-1},writeSync(n,s){r+=g.decode(s);const i=r.lastIndexOf(`\n`);return i!=-1&&(console.log(r.substr(0,i)),r=r.substr(i+1)),s.length},write(n,s,i,l,f,h){if(i!==0||l!==s.length||f!==null){h(a());return}const u=this.writeSync(n,s);h(null,u)},chmod(n,s,i){i(a())},chown(n,s,i,l){l(a())},close(n,s){s(a())},fchmod(n,s,i){i(a())},fchown(n,s,i,l){l(a())},fstat(n,s){s(a())},fsync(n,s){s(null)},ftruncate(n,s,i){i(a())},lchown(n,s,i,l){l(a())},link(n,s,i){i(a())},lstat(n,s){s(a())},mkdir(n,s,i){i(a())},open(n,s,i,l){l(a())},read(n,s,i,l,f,h){h(a())},readdir(n,s){s(a())},readlink(n,s){s(a())},rename(n,s,i){i(a())},rmdir(n,s){s(a())},stat(n,s){s(a())},symlink(n,s,i){i(a())},truncate(n,s,i){i(a())},unlink(n,s){s(a())},utimes(n,s,i,l){l(a())}}}if(global.process||(global.process={getuid(){return-1},getgid(){return-1},geteuid(){return-1},getegid(){return-1},getgroups(){throw a()},pid:-1,ppid:-1,umask(){throw a()},cwd(){throw a()},chdir(){throw a()}}),!global.crypto&&global.require){const r=require("crypto");global.crypto={getRandomValues(n){r.randomFillSync(n)}}}if(!global.crypto)throw new Error("global.crypto is not available, polyfill required (getRandomValues only)");if(global.performance||(global.performance={now(){const[r,n]=process.hrtime();return r*1e3+n/1e6}}),!global.TextEncoder&&global.require&&(global.TextEncoder=require("util").TextEncoder),!global.TextEncoder)throw new Error("global.TextEncoder is not available, polyfill required");if(!global.TextDecoder&&global.require&&(global.TextDecoder=require("util").TextDecoder),!global.TextDecoder)throw new Error("global.TextDecoder is not available, polyfill required");const d=new TextEncoder("utf-8"),g=new TextDecoder("utf-8");if(global.Go=class{constructor(){this.argv=["js"],this.env={},this.exit=e=>{e!==0&&console.warn("exit code:",e)},this._exitPromise=new Promise(e=>{this._resolveExitPromise=e}),this._pendingEvent=null,this._scheduledTimeouts=new Map,this._nextCallbackTimeoutID=1;const r=(e,t)=>{this.mem.setUint32(e+0,t,!0),this.mem.setUint32(e+4,Math.floor(t/4294967296),!0)},n=e=>{const t=this.mem.getUint32(e+0,!0),o=this.mem.getInt32(e+4,!0);return t+o*4294967296},s=e=>{const t=this.mem.getFloat64(e,!0);if(t===0)return;if(!isNaN(t))return t;const o=this.mem.getUint32(e,!0);return this._values[o]},i=(e,t)=>{const o=2146959360;if(typeof t=="number"&&t!==0){if(isNaN(t)){this.mem.setUint32(e+4,o,!0),this.mem.setUint32(e,0,!0);return}this.mem.setFloat64(e,t,!0);return}if(t===void 0){this.mem.setFloat64(e,0,!0);return}let c=this._ids.get(t);c===void 0&&(c=this._idPool.pop(),c===void 0&&(c=this._values.length),this._values[c]=t,this._goRefCounts[c]=0,this._ids.set(t,c)),this._goRefCounts[c]++;let m=0;switch(typeof t){case"object":t!==null&&(m=1);break;case"string":m=2;break;case"symbol":m=3;break;case"function":m=4;break}this.mem.setUint32(e+4,o|m,!0),this.mem.setUint32(e,c,!0)},l=e=>{const t=n(e+0),o=n(e+8);return new Uint8Array(this._inst.exports.mem.buffer,t,o)},f=e=>{const t=n(e+0),o=n(e+8),c=new Array(o);for(let m=0;m<o;m++)c[m]=s(t+m*8);return c},h=e=>{const t=n(e+0),o=n(e+8);return g.decode(new DataView(this._inst.exports.mem.buffer,t,o))},u=Date.now()-performance.now();this.importObject={go:{"runtime.wasmExit":e=>{e>>>=0;const t=this.mem.getInt32(e+8,!0);this.exited=!0,delete this._inst,delete this._values,delete this._goRefCounts,delete this._ids,delete this._idPool,this.exit(t)},"runtime.wasmWrite":e=>{e>>>=0;const t=n(e+8),o=n(e+16),c=this.mem.getInt32(e+24,!0);fs.writeSync(t,new Uint8Array(this._inst.exports.mem.buffer,o,c))},"runtime.resetMemoryDataView":e=>{e>>>=0,this.mem=new DataView(this._inst.exports.mem.buffer)},"runtime.nanotime1":e=>{e>>>=0,r(e+8,(u+performance.now())*1e6)},"runtime.walltime1":e=>{e>>>=0;const t=new Date().getTime();r(e+8,t/1e3),this.mem.setInt32(e+16,t%1e3*1e6,!0)},"runtime.scheduleTimeoutEvent":e=>{e>>>=0;const t=this._nextCallbackTimeoutID;this._nextCallbackTimeoutID++,this._scheduledTimeouts.set(t,setTimeout(()=>{for(this._resume();this._scheduledTimeouts.has(t);)console.warn("scheduleTimeoutEvent: missed timeout event"),this._resume()},n(e+8)+1)),this.mem.setInt32(e+16,t,!0)},"runtime.clearTimeoutEvent":e=>{e>>>=0;const t=this.mem.getInt32(e+8,!0);clearTimeout(this._scheduledTimeouts.get(t)),this._scheduledTimeouts.delete(t)},"runtime.getRandomData":e=>{e>>>=0,crypto.getRandomValues(l(e+8))},"syscall/js.finalizeRef":e=>{e>>>=0;const t=this.mem.getUint32(e+8,!0);if(this._goRefCounts[t]--,this._goRefCounts[t]===0){const o=this._values[t];this._values[t]=null,this._ids.delete(o),this._idPool.push(t)}},"syscall/js.stringVal":e=>{e>>>=0,i(e+24,h(e+8))},"syscall/js.valueGet":e=>{e>>>=0;const t=Reflect.get(s(e+8),h(e+16));e=this._inst.exports.getsp()>>>0,i(e+32,t)},"syscall/js.valueSet":e=>{e>>>=0,Reflect.set(s(e+8),h(e+16),s(e+32))},"syscall/js.valueDelete":e=>{e>>>=0,Reflect.deleteProperty(s(e+8),h(e+16))},"syscall/js.valueIndex":e=>{e>>>=0,i(e+24,Reflect.get(s(e+8),n(e+16)))},"syscall/js.valueSetIndex":e=>{e>>>=0,Reflect.set(s(e+8),n(e+16),s(e+24))},"syscall/js.valueCall":e=>{e>>>=0;try{const t=s(e+8),o=Reflect.get(t,h(e+16)),c=f(e+32),m=Reflect.apply(o,t,c);e=this._inst.exports.getsp()>>>0,i(e+56,m),this.mem.setUint8(e+64,1)}catch(t){i(e+56,t),this.mem.setUint8(e+64,0)}},"syscall/js.valueInvoke":e=>{e>>>=0;try{const t=s(e+8),o=f(e+16),c=Reflect.apply(t,void 0,o);e=this._inst.exports.getsp()>>>0,i(e+40,c),this.mem.setUint8(e+48,1)}catch(t){i(e+40,t),this.mem.setUint8(e+48,0)}},"syscall/js.valueNew":e=>{e>>>=0;try{const t=s(e+8),o=f(e+16),c=Reflect.construct(t,o);e=this._inst.exports.getsp()>>>0,i(e+40,c),this.mem.setUint8(e+48,1)}catch(t){i(e+40,t),this.mem.setUint8(e+48,0)}},"syscall/js.valueLength":e=>{e>>>=0,r(e+16,parseInt(s(e+8).length))},"syscall/js.valuePrepareString":e=>{e>>>=0;const t=d.encode(String(s(e+8)));i(e+16,t),r(e+24,t.length)},"syscall/js.valueLoadString":e=>{e>>>=0;const t=s(e+8);l(e+16).set(t)},"syscall/js.valueInstanceOf":e=>{e>>>=0,this.mem.setUint8(e+24,s(e+8)instanceof s(e+16)?1:0)},"syscall/js.copyBytesToGo":e=>{e>>>=0;const t=l(e+8),o=s(e+32);if(!(o instanceof Uint8Array||o instanceof Uint8ClampedArray)){this.mem.setUint8(e+48,0);return}const c=o.subarray(0,t.length);t.set(c),r(e+40,c.length),this.mem.setUint8(e+48,1)},"syscall/js.copyBytesToJS":e=>{e>>>=0;const t=s(e+8),o=l(e+16);if(!(t instanceof Uint8Array||t instanceof Uint8ClampedArray)){this.mem.setUint8(e+48,0);return}const c=o.subarray(0,t.length);t.set(c),r(e+40,c.length),this.mem.setUint8(e+48,1)},debug:e=>{console.log(e)}}}}async run(r){if(!(r instanceof WebAssembly.Instance))throw new Error("Go.run: WebAssembly.Instance expected");this._inst=r,this.mem=new DataView(this._inst.exports.mem.buffer),this._values=[NaN,0,null,!0,!1,global,this],this._goRefCounts=new Array(this._values.length).fill(Infinity),this._ids=new Map([[0,1],[null,2],[!0,3],[!1,4],[global,5],[this,6]]),this._idPool=[],this.exited=!1;let n=4096;const s=u=>{const e=n,t=d.encode(u+"\\0");return new Uint8Array(this.mem.buffer,n,t.length).set(t),n+=t.length,n%8!=0&&(n+=8-n%8),e},i=this.argv.length,l=[];this.argv.forEach(u=>{l.push(s(u))}),l.push(0),Object.keys(this.env).sort().forEach(u=>{l.push(s(`${u}=${this.env[u]}`))}),l.push(0);const h=n;l.forEach(u=>{this.mem.setUint32(n,u,!0),this.mem.setUint32(n+4,0,!0),n+=8}),this._inst.exports.run(i,h),this.exited&&this._resolveExitPromise(),await this._exitPromise}_resume(){if(this.exited)throw new Error("Go program has already exited");this._inst.exports.resume(),this.exited&&this._resolveExitPromise()}_makeFuncWrapper(r){const n=this;return function(){const s={id:r,this:this,args:arguments};return n._pendingEvent=s,n._resume(),s.result}}},typeof module!="undefined"&&global.require&&global.require.main===module&&global.process&&global.process.versions&&!global.process.versions.electron){process.argv.length<3&&(console.error("usage: go_js_wasm_exec [wasm binary] [arguments]"),process.exit(1));const r=new Go;r.argv=process.argv.slice(2),r.env=Object.assign({TMPDIR:require("os").tmpdir()},process.env),r.exit=process.exit,WebAssembly.instantiate(fs.readFileSync(process.argv[2]),r.importObject).then(n=>(process.on("exit",s=>{s===0&&!r.exited&&(r._pendingEvent={id:0},r._resume())}),r.run(n.instance))).catch(n=>{console.error(n),process.exit(1)})}})();\nonmessage=({data:c})=>{let y=new TextDecoder,s=global.fs,a="";s.writeSync=(e,t)=>{if(e===1)postMessage(t);else if(e===2){a+=y.decode(t);let n=a.split(`\n`);n.length>1&&console.log(n.slice(0,-1).join(`\n`)),a=n[n.length-1]}else throw new Error("Bad write");return t.length};let l=[],i,r=0;onmessage=({data:e})=>{e.length>0&&(l.push(e),i&&i())},s.read=(e,t,n,d,h,m)=>{if(e!==0||n!==0||d!==t.length||h!==null)throw new Error("Bad read");if(l.length===0){i=()=>s.read(e,t,n,d,h,m);return}let g=l[0],u=Math.max(0,Math.min(d,g.length-r));t.set(g.subarray(r,r+u),n),r+=u,r===g.length&&(l.shift(),r=0),m(null,u)};let o=new global.Go;o.argv=["","--service=0.8.57"],WebAssembly.instantiate(c,o.importObject).then(({instance:e})=>o.run(e))};}',i;if(r){let b=new Blob([l],{type:"text/javascript"});i=new Worker(URL.createObjectURL(b))}else{let F=new Function("postMessage",l+"var onmessage; return m => onmessage(m)")(B=>i.onmessage({data:B}));i={onmessage:null,postMessage:B=>F({data:B}),terminate(){}}}i.postMessage(a),i.onmessage=({data:b})=>m(b);let{readFromStdout:m,afterClose:v,service:h}=je({writeToStdin(b){i.postMessage(b)},isSync:!1,isBrowser:!0});return{build:b=>new Promise((F,B)=>h.buildOrServe("build",null,null,b,!1,"/",($,D)=>$?B($):F(D))),transform:(b,F)=>(b+="",new Promise((B,$)=>h.transform("transform",null,b,F||{},!1,{readFile(D,C){C(new Error("Internal error"),null)},writeFile(D,C){C(null)}},(D,C)=>D?$(D):B(C)))),serve(){throw new Error('The "serve" API only works in node')},buildSync(){throw new Error('The "buildSync" API only works in node')},transformSync(){throw new Error('The "transformSync" API only works in node')},stop(){i.terminate(),v()}}});export{ze as build,Ge as buildSync,Ze as serve,Xe as startService,He as transform,Qe as transformSync,Je as version};
